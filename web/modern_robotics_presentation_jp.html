<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Robotics: 理論から実装まで</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            overflow: hidden;
        }
        
        .presentation-container {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .slide {
            display: none;
            width: 90%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            padding: 60px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
        }
        
        .slide.active {
            display: block;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }
        
        h2 {
            color: #764ba2;
            margin: 30px 0 20px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #555;
            margin: 20px 0 15px;
            font-size: 1.4em;
        }
        
        p, li {
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        ul {
            margin-left: 30px;
            margin-bottom: 20px;
        }
        
        .code-block {
            background: #f4f4f4;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            border-radius: 5px;
            overflow-x: auto;
        }
        
        .navigation {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 1000;
        }
        
        button {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        button:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .slide-number {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            color: #667eea;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .highlight {
            background: linear-gradient(120deg, #ffd700 0%, #ffed4e 100%);
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .equation {
            background: #f9f9f9;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 1.2em;
            border: 1px solid #e0e0e0;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .concept-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .concept-box h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .timeline {
            position: relative;
            padding: 20px 0;
        }
        
        .timeline-item {
            padding: 10px 20px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            margin-bottom: 15px;
            border-radius: 0 5px 5px 0;
        }
        
        .github-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: #24292e;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            margin: 20px 0;
            transition: all 0.3s;
        }
        
        .github-link:hover {
            background: #2ea44f;
            transform: translateY(-2px);
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s;
            z-index: 1001;
        }
        
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .course-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .course-card:hover {
            transform: scale(1.05);
        }
        
        .course-card h4 {
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .demo-section {
            background: #f0f8ff;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #667eea;
        }
        
        @media (max-width: 768px) {
            .slide {
                padding: 30px;
            }
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.4em; }
            .two-column { grid-template-columns: 1fr; }
            .overview-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>
    <div class="slide-number" id="slideNumber">1 / 20</div>
    
    <div class="presentation-container">
        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>🤖 Modern Robotics: 理論から実装まで</h1>
            <h2>Northwestern University専門講座の統合プレゼンテーション</h2>
            <div style="text-align: center; margin: 40px 0;">
                <p style="font-size: 1.3em; color: #667eea;">ロボット工学の数学的基礎から実装まで</p>
                <p style="font-size: 1.1em; margin-top: 20px;">60分で学ぶ6コースの旅</p>
            </div>
            <div class="github-link" style="margin: 40px auto; width: fit-content;">
                <span>📦</span>
                <span>Capstone Project: github.com/hafnium49/modern_robotics_capstone_project</span>
            </div>
            <div class="equation">
                <p>Kevin Lynch & Frank Park 著「Modern Robotics」に基づく</p>
            </div>
        </div>

        <!-- Slide 2: Overview -->
        <div class="slide">
            <h1>📚 講座の全体像</h1>
            <h2>6つのコースで構成される包括的なロボティクス教育</h2>
            <div class="overview-grid">
                <div class="course-card">
                    <h4>Course 1</h4>
                    <p>ロボット運動の基礎</p>
                    <small>Configuration Space & 剛体運動</small>
                </div>
                <div class="course-card">
                    <h4>Course 2</h4>
                    <p>ロボットキネマティクス</p>
                    <small>順・逆運動学</small>
                </div>
                <div class="course-card">
                    <h4>Course 3</h4>
                    <p>ロボットダイナミクス</p>
                    <small>力とトルクの世界</small>
                </div>
                <div class="course-card">
                    <h4>Course 4</h4>
                    <p>軌道生成と制御</p>
                    <small>動作計画とフィードバック</small>
                </div>
                <div class="course-card">
                    <h4>Course 5</h4>
                    <p>マニピュレーション</p>
                    <small>把持と移動ロボット</small>
                </div>
                <div class="course-card">
                    <h4>Course 6</h4>
                    <p>Capstone Project</p>
                    <small>モバイルマニピュレーション実装</small>
                </div>
            </div>
            <p style="text-align: center; margin-top: 30px; font-style: italic;">
                "理論と実装の美しい融合" - すべてがCapstone Projectで統合される
            </p>
        </div>

        <!-- Slide 3: The Journey Begins -->
        <div class="slide">
            <h1>🎯 なぜModern Roboticsなのか？</h1>
            <h2>従来のアプローチとの違い</h2>
            <div class="two-column">
                <div class="concept-box">
                    <h4>❌ 従来のアプローチ</h4>
                    <ul>
                        <li>Denavit-Hartenberg (D-H) パラメータ</li>
                        <li>各関節に座標系を設定</li>
                        <li>複雑な記号操作</li>
                        <li>特異点での問題</li>
                    </ul>
                </div>
                <div class="concept-box">
                    <h4>✅ Modern Roboticsアプローチ</h4>
                    <ul>
                        <li><span class="highlight">Product of Exponentials (PoE)</span></li>
                        <li>スクリュー理論とLie群</li>
                        <li>グローバルに有効</li>
                        <li>計算効率が高い</li>
                    </ul>
                </div>
            </div>
            <div class="equation">
                T(θ) = e^{[S₁]θ₁} e^{[S₂]θ₂} ... e^{[Sₙ]θₙ} M
            </div>
            <p style="text-align: center;">
                <strong>キーポイント：</strong> 幾何学的直感と代数的エレガンスの融合
            </p>
        </div>

        <!-- Slide 4: Configuration Space -->
        <div class="slide">
            <h1>🌍 Course 1: Configuration Space（C空間）</h1>
            <h2>ロボットの「居場所」を数学的に定義する</h2>
            <div class="concept-box">
                <h4>Configuration（配置）とは？</h4>
                <p>ロボットのすべての点の位置を完全に指定する最小限のパラメータ集合</p>
            </div>
            <div class="two-column">
                <div>
                    <h3>自由度の計算：Grüblerの公式</h3>
                    <div class="equation">
                        DoF = m(N-1-J) + Σfᵢ
                    </div>
                    <ul>
                        <li>m: 空間次元（平面=3, 空間=6）</li>
                        <li>N: リンク数</li>
                        <li>J: ジョイント数</li>
                        <li>fᵢ: 各ジョイントの自由度</li>
                    </ul>
                </div>
                <div>
                    <h3>実例：2R平面アーム</h3>
                    <ul>
                        <li>C空間: トーラス T² = S¹ × S¹</li>
                        <li>各関節角度が周期的</li>
                        <li>直線的な関節空間パスは曲線的な作業空間パス</li>
                    </ul>
                    <div class="code-block">
                        θ = [θ₁, θ₂]  # 関節角度
                        # C空間での点が一意に
                        # ロボットの姿勢を決定
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: Rigid Body Motion -->
        <div class="slide">
            <h1>🔄 剛体運動とSE(3)</h1>
            <h2>回転と並進の美しい統一理論</h2>
            <div class="concept-box">
                <h4>同次変換行列</h4>
                <div class="equation">
                    T = [R  p]  ∈ SE(3)
                        [0  1]
                </div>
            </div>
            <div class="two-column">
                <div>
                    <h3>🔄 回転：SO(3)</h3>
                    <ul>
                        <li>3×3直交行列</li>
                        <li>det(R) = 1</li>
                        <li>軸-角度表現: R = e^{[ω̂]θ}</li>
                        <li>Rodriguesの公式</li>
                    </ul>
                </div>
                <div>
                    <h3>➡️ Twist（ツイスト）</h3>
                    <ul>
                        <li>瞬間的な速度を表現</li>
                        <li>V = [ω, v] （6次元ベクトル）</li>
                        <li>スクリュー運動の一般化</li>
                        <li>Body vs Space frame</li>
                    </ul>
                </div>
            </div>
            <div class="code-block">
# Modern Roboticsライブラリの使用例
import modern_robotics as mr
T = mr.MatrixExp6(se3mat)  # 指数写像
V = mr.se3ToVec(mr.MatrixLog6(T))  # 対数写像
            </div>
        </div>

        <!-- Slide 6: Forward Kinematics -->
        <div class="slide">
            <h1>⚙️ Course 2: 順運動学（Forward Kinematics）</h1>
            <h2>関節角度からエンドエフェクタ位置への写像</h2>
            <div class="concept-box">
                <h4>Product of Exponentials (PoE) アプローチ</h4>
                <p>各関節を空間内のスクリュー軸として扱う</p>
            </div>
            <div class="equation">
                T(θ) = e^{[S₁]θ₁} e^{[S₂]θ₂} ... e^{[Sₙ]θₙ} M
            </div>
            <h3>実装の3ステップ</h3>
            <div class="timeline">
                <div class="timeline-item">
                    <strong>Step 1:</strong> ホームポーズMを測定
                </div>
                <div class="timeline-item">
                    <strong>Step 2:</strong> 各関節のスクリュー軸Sᵢを計算
                    <ul>
                        <li>回転関節: ω̂ = 単位軸, v = -ω̂×q</li>
                        <li>並進関節: ω = 0, v = 単位方向</li>
                    </ul>
                </div>
                <div class="timeline-item">
                    <strong>Step 3:</strong> PoE公式を評価
                    <div class="code-block">T = mr.FKinSpace(M, Slist, theta)</div>
                </div>
            </div>
        </div>

        <!-- Slide 7: Jacobian -->
        <div class="slide">
            <h1>📐 ヤコビアンと速度運動学</h1>
            <h2>関節速度からタスク空間速度への写像</h2>
            <div class="equation">
                V = J(θ) θ̇
            </div>
            <div class="two-column">
                <div class="concept-box">
                    <h4>ヤコビアンの物理的意味</h4>
                    <ul>
                        <li>各列 = 1つの関節だけが動いた時のツイスト</li>
                        <li>特異点 = rank(J) < 6</li>
                        <li>マニピュラビリティ楕円体</li>
                    </ul>
                </div>
                <div class="concept-box">
                    <h4>静力学への応用</h4>
                    <div class="equation">
                        τ = J^T(θ) F
                    </div>
                    <p>同じヤコビアンが力の伝達も記述</p>
                </div>
            </div>
            <h3>🎯 実用的な洞察</h3>
            <ul>
                <li><span class="highlight">特異点近傍</span>では小さな力で大きなトルクを発生可能</li>
                <li>冗長性がある場合、null空間を利用して副次的タスクを実行</li>
            </ul>
        </div>

        <!-- Slide 8: Inverse Kinematics -->
        <div class="slide">
            <h1>🎯 逆運動学（Inverse Kinematics）</h1>
            <h2>望みの姿勢を実現する関節角度を見つける</h2>
            <div class="two-column">
                <div class="concept-box">
                    <h4>解析的アプローチ</h4>
                    <ul>
                        <li>PUMA型6Rアーム</li>
                        <li>手首の分離</li>
                        <li>複数解の存在（最大2^n）</li>
                    </ul>
                </div>
                <div class="concept-box">
                    <h4>数値的アプローチ</h4>
                    <div class="code-block">
θₖ₊₁ = θₖ + J†(θₖ) eₖ
                    </div>
                    <ul>
                        <li>Newton-Raphson法</li>
                        <li>擬似逆行列の使用</li>
                        <li>収束性の保証</li>
                    </ul>
                </div>
            </div>
            <div class="demo-section">
                <h3>💡 実装のコツ</h3>
                <p>• 良い初期推定値を使用（前回の解や粗い解析解）</p>
                <p>• 特異点近傍では減衰最小二乗法を使用</p>
                <p>• 冗長アームではnull空間を活用</p>
            </div>
        </div>

        <!-- Slide 9: Dynamics Introduction -->
        <div class="slide">
            <h1>💪 Course 3: ロボットダイナミクス</h1>
            <h2>力とトルクの世界へ</h2>
            <div class="concept-box">
                <h4>運動方程式</h4>
                <div class="equation">
                    τ = M(θ)θ̈ + c(θ,θ̇) + g(θ)
                </div>
            </div>
            <div class="timeline">
                <div class="timeline-item">
                    <strong>M(θ):</strong> 質量行列（対称・正定値）
                </div>
                <div class="timeline-item">
                    <strong>c(θ,θ̇):</strong> コリオリ・遠心力項
                </div>
                <div class="timeline-item">
                    <strong>g(θ):</strong> 重力項
                </div>
            </div>
            <h3>2つの定式化アプローチ</h3>
            <div class="two-column">
                <div class="concept-box">
                    <h4>Lagrange法</h4>
                    <p>エネルギーベースの導出</p>
                    <p>K - P = L（ラグランジアン）</p>
                </div>
                <div class="concept-box">
                    <h4>Newton-Euler法</h4>
                    <p>力とモーメントの再帰的計算</p>
                    <p>計算効率: O(n)</p>
                </div>
            </div>
        </div>

        <!-- Slide 10: Recursive Newton-Euler -->
        <div class="slide">
            <h1>🔄 再帰的Newton-Euler法（RNEA）</h1>
            <h2>効率的な動力学計算</h2>
            <div class="concept-box">
                <h4>2パスアルゴリズム</h4>
            </div>
            <div class="two-column">
                <div>
                    <h3>➡️ Forward Pass</h3>
                    <p>基部→先端</p>
                    <ul>
                        <li>速度の伝播</li>
                        <li>加速度の計算</li>
                        <li>各リンクのツイスト更新</li>
                    </ul>
                </div>
                <div>
                    <h3>⬅️ Backward Pass</h3>
                    <p>先端→基部</p>
                    <ul>
                        <li>レンチの累積</li>
                        <li>関節トルクの投影</li>
                        <li>τᵢ = Aᵢᵀ Fᵢ</li>
                    </ul>
                </div>
            </div>
            <div class="code-block">
# Forward Dynamics: τ → θ̈
M = ComputeMassMatrix(theta)
h = ComputeBiasForces(theta, theta_dot)
theta_ddot = np.linalg.solve(M, tau - h)
            </div>
            <p style="text-align: center; margin-top: 20px;">
                <strong>応用：</strong> シミュレータ、トルク制御、動的補償
            </p>
        </div>

        <!-- Slide 11: Trajectory Generation -->
        <div class="slide">
            <h1>📈 Course 4: 軌道生成</h1>
            <h2>パスと時間スケーリングの分離</h2>
            <div class="concept-box">
                <h4>基本概念</h4>
                <p><strong>軌道 = パス（幾何学）+ 時間スケーリング</strong></p>
            </div>
            <div class="two-column">
                <div>
                    <h3>パスの種類</h3>
                    <ul>
                        <li><strong>関節空間直線:</strong> θ(s) = θ₀ + s(θf - θ₀)</li>
                        <li><strong>タスク空間直線:</strong> デカップル並進+回転</li>
                        <li><strong>定スクリュー運動:</strong> SE(3)での補間</li>
                    </ul>
                </div>
                <div>
                    <h3>時間スケーリング</h3>
                    <ul>
                        <li><strong>台形速度:</strong> 加速-定速-減速</li>
                        <li><strong>S字カーブ:</strong> ジャーク制限</li>
                        <li><strong>5次多項式:</strong> 滑らかな始終点</li>
                    </ul>
                </div>
            </div>
            <div class="equation">
                s(t): [0,T] → [0,1]  (単調増加、C²連続)
            </div>
        </div>

        <!-- Slide 12: Time-Optimal Control -->
        <div class="slide">
            <h1>⚡ 時間最適制御</h1>
            <h2>トルク制限下での最速動作</h2>
            <div class="concept-box">
                <h4>Phase Plane解析</h4>
                <p>経路パラメータ s と速度 ṡ の2次元空間での可視化</p>
            </div>
            <div class="equation">
                L(s,ṡ) ≤ s̈ ≤ U(s,ṡ)
            </div>
            <h3>Bang-Bang制御の原理</h3>
            <ul>
                <li>常に加速度限界で動作（最大加速 or 最大減速）</li>
                <li>速度限界カーブに沿った移動</li>
                <li>スイッチング点の計算</li>
            </ul>
            <div class="demo-section">
                <h3>🏭 産業での実装</h3>
                <p>• 理論的最適解は振動を引き起こす</p>
                <p>• 実用では10-20%のマージンを確保</p>
                <p>• S字カーブで滑らかに近似</p>
            </div>
        </div>

        <!-- Slide 13: Motion Planning -->
        <div class="slide">
            <h1>🗺️ 動作計画（Motion Planning）</h1>
            <h2>障害物回避とパス探索</h2>
            <div class="two-column">
                <div class="concept-box">
                    <h4>C空間での計画</h4>
                    <ul>
                        <li>ロボットを点に縮退</li>
                        <li>障害物をC障害物に変換</li>
                        <li>自由空間での探索</li>
                    </ul>
                </div>
                <div class="concept-box">
                    <h4>アルゴリズムの種類</h4>
                    <ul>
                        <li><strong>Grid-based:</strong> A*</li>
                        <li><strong>Sampling:</strong> PRM, RRT</li>
                        <li><strong>Potential Field:</strong> 局所的回避</li>
                        <li><strong>Optimization:</strong> CHOMP, TrajOpt</li>
                    </ul>
                </div>
            </div>
            <div class="code-block">
# RRTの基本構造
def RRT(start, goal, obstacles):
    tree = [start]
    while not reached_goal:
        random_point = sample()
        nearest = find_nearest(tree, random_point)
        new_point = steer(nearest, random_point)
        if collision_free(nearest, new_point):
            tree.append(new_point)
    return extract_path(tree)
            </div>
        </div>

        <!-- Slide 14: Robot Control -->
        <div class="slide">
            <h1>🎮 ロボット制御</h1>
            <h2>フィードバック制御の実装</h2>
            <div class="concept-box">
                <h4>タスク空間PI制御</h4>
                <div class="equation">
                    V = Ad_{X⁻¹Xd} Vd + Kp Xe + Ki ∫Xe dt
                </div>
            </div>
            <div class="two-column">
                <div>
                    <h3>速度制御モード</h3>
                    <ul>
                        <li>P制御: 定常偏差あり</li>
                        <li>PI制御: 定常偏差なし</li>
                        <li>フィードフォワード付きPI推奨</li>
                    </ul>
                </div>
                <div>
                    <h3>トルク制御モード</h3>
                    <ul>
                        <li>計算トルク法</li>
                        <li>動的補償</li>
                        <li>τ = M(θ)[θ̈d + PID] + h(θ,θ̇)</li>
                    </ul>
                </div>
            </div>
            <div class="demo-section">
                <h3>🔧 チューニングのコツ</h3>
                <p>• Kp → 応答速度、Ki → 定常偏差除去</p>
                <p>• 臨界減衰: Ki = Kp²/4</p>
                <p>• 積分飽和対策を忘れずに</p>
            </div>
        </div>

        <!-- Slide 15: Grasping and Manipulation -->
        <div class="slide">
            <h1>🤏 Course 5: 把持とマニピュレーション</h1>
            <h2>接触と摩擦の物理学</h2>
            <div class="concept-box">
                <h4>Coulomb摩擦モデル</h4>
                <div class="equation">
                    ‖f_t‖ ≤ μf_n, f_n ≥ 0
                </div>
            </div>
            <div class="two-column">
                <div>
                    <h3>接触の分類</h3>
                    <ul>
                        <li><strong>B (Breaking):</strong> 離れる</li>
                        <li><strong>S (Sliding):</strong> 滑り</li>
                        <li><strong>R (Rolling):</strong> 転がり/固着</li>
                    </ul>
                </div>
                <div>
                    <h3>把持の条件</h3>
                    <ul>
                        <li><strong>Form Closure:</strong> 幾何学的拘束</li>
                        <li><strong>Force Closure:</strong> 摩擦含む拘束</li>
                        <li>平面: 2接触で力閉包可能</li>
                    </ul>
                </div>
            </div>
            <div class="code-block">
# Force Closure判定
def is_force_closure(contact_points, normals, mu):
    F = compute_wrench_matrix(contact_points, normals, mu)
    rank = np.linalg.matrix_rank(F)
    # LPで正のスパンをチェック
    return rank == 6 and check_positive_span(F)
            </div>
        </div>

        <!-- Slide 16: Mobile Robots -->
        <div class="slide">
            <h1>🚗 車輪移動ロボット</h1>
            <h2>非ホロノミック拘束との共存</h2>
            <div class="two-column">
                <div class="concept-box">
                    <h4>全方向移動</h4>
                    <ul>
                        <li>オムニホイール</li>
                        <li>メカナムホイール</li>
                        <li>3自由度の瞬間移動</li>
                        <li>H行列: u = H(φ) V_b</li>
                    </ul>
                </div>
                <div class="concept-box">
                    <h4>非ホロノミック</h4>
                    <ul>
                        <li>差動駆動</li>
                        <li>アッカーマンステアリング</li>
                        <li>横滑り不可: ẋsinφ - ẏcosφ = 0</li>
                        <li>Lie bracket による到達可能性</li>
                    </ul>
                </div>
            </div>
            <div class="demo-section">
                <h3>🎯 youBotの特徴</h3>
                <p>• 4輪メカナムベース + 5自由度アーム</p>
                <p>• 全方向移動可能なモバイルマニピュレータ</p>
                <p>• Capstone Projectの主役</p>
            </div>
        </div>

        <!-- Slide 17: Capstone Project Overview -->
        <div class="slide">
            <h1>🏆 Course 6: Capstone Project</h1>
            <h2>KUKA youBotによるピック&プレース実装</h2>
            <div class="concept-box">
                <h4>プロジェクト概要</h4>
                <p>CoppeliaSim環境でyouBotを制御し、立方体を掴んで目標位置に配置</p>
            </div>
            <h3>8つの動作セグメント</h3>
            <div class="timeline">
                <div class="timeline-item">1. Approach standoff - キューブ上方へ接近</div>
                <div class="timeline-item">2. Descend to grasp - 把持位置まで降下</div>
                <div class="timeline-item">3. Close gripper - グリッパーを閉じる（0.63秒）</div>
                <div class="timeline-item">4. Lift to standoff - 持ち上げ</div>
                <div class="timeline-item">5. Transit to goal - 目標位置へ移動</div>
                <div class="timeline-item">6. Descend to place - 配置位置まで降下</div>
                <div class="timeline-item">7. Open gripper - グリッパーを開く</div>
                <div class="timeline-item">8. Retreat - 退避</div>
            </div>
        </div>

        <!-- Slide 18: Capstone Implementation -->
        <div class="slide">
            <h1>💻 実装の詳細</h1>
            <h2>4つのマイルストーン</h2>
            <div class="overview-grid">
                <div class="concept-box">
                    <h4>Milestone 1: NextState</h4>
                    <p>キネマティクスシミュレータ</p>
                    <div class="code-block" style="font-size: 0.9em;">
# オドメトリ更新
V_b = F @ wheel_speeds
T_sb_new = T_sb @ expm(VecTose3(V_b*dt))
                    </div>
                </div>
                <div class="concept-box">
                    <h4>Milestone 2: TrajectoryGen</h4>
                    <p>参照軌道の生成</p>
                    <div class="code-block" style="font-size: 0.9em;">
traj = mr.ScrewTrajectory(
    T_start, T_end, 
    duration, N, 5)  # 5次
                    </div>
                </div>
                <div class="concept-box">
                    <h4>Milestone 3: FeedForward</h4>
                    <p>フィードフォワード制御</p>
                    <div class="code-block" style="font-size: 0.9em;">
V_d = se3ToVec(log(X_d_inv @ X_d_next))/dt
V = Adjoint(X_inv @ X_d) @ V_d
                    </div>
                </div>
                <div class="concept-box">
                    <h4>Milestone 4: Feedback</h4>
                    <p>PI制御の追加</p>
                    <div class="code-block" style="font-size: 0.9em;">
X_err = se3ToVec(log(X_inv @ X_d))
V = V_ff + Kp@X_err + Ki@integral
controls = J_pinv @ V
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 19: Results and Insights -->
        <div class="slide">
            <h1>📊 実装結果と知見</h1>
            <h2>Capstone Projectから学んだこと</h2>
            <div class="two-column">
                <div class="concept-box">
                    <h4>技術的成果</h4>
                    <ul>
                        <li>位置誤差: < 1cm収束</li>
                        <li>姿勢誤差: < 5°収束</li>
                        <li>8セグメント全完走</li>
                        <li>PI制御による安定把持</li>
                    </ul>
                </div>
                <div class="concept-box">
                    <h4>実装の課題と解決</h4>
                    <ul>
                        <li><strong>特異点回避:</strong> 擬似逆行列の減衰</li>
                        <li><strong>積分飽和:</strong> アンチワインドアップ</li>
                        <li><strong>速度制限:</strong> 12.3 rad/sでクリップ</li>
                        <li><strong>初期誤差:</strong> 30°以上で収束確認</li>
                    </ul>
                </div>
            </div>
            <div class="demo-section">
                <h3>🔍 Key Insights</h3>
                <p>✅ <strong>フィードフォワードの重要性:</strong> 大部分の動作はFFで実現、FBは補正のみ</p>
                <p>✅ <strong>ゲイン調整:</strong> Kp=2-4、Ki=0.05-0.2で臨界減衰に近い応答</p>
                <p>✅ <strong>統合の価値:</strong> 6コースの知識が1つのシステムで結実</p>
            </div>
            <div class="github-link" style="margin: 30px auto; width: fit-content;">
                <span>🔗</span>
                <span>完全なコードとドキュメント: GitHub Repository</span>
            </div>
        </div>

        <!-- Slide 20: Conclusion -->
        <div class="slide">
            <h1>🎯 まとめ：理論から実装への旅</h1>
            <h2>Modern Roboticsが教えてくれたこと</h2>
            <div class="concept-box" style="background: linear-gradient(135deg, #667eea15, #764ba215); border-color: #667eea;">
                <h3 style="text-align: center; color: #667eea;">6つの重要な学び</h3>
            </div>
            <div class="timeline">
                <div class="timeline-item">
                    <strong>1. 数学的基礎の重要性</strong>
                    <p>Lie群とスクリュー理論が複雑な動作を簡潔に表現</p>
                </div>
                <div class="timeline-item">
                    <strong>2. 統一的フレームワーク</strong>
                    <p>Product of Exponentialsが順・逆運動学を統一</p>
                </div>
                <div class="timeline-item">
                    <strong>3. 計算効率</strong>
                    <p>再帰的アルゴリズムでリアルタイム制御を実現</p>
                </div>
                <div class="timeline-item">
                    <strong>4. 制御の階層性</strong>
                    <p>フィードフォワード + フィードバックの組み合わせが鍵</p>
                </div>
                <div class="timeline-item">
                    <strong>5. 実装の現実</strong>
                    <p>理論と実装のギャップを埋める工夫の必要性</p>
                </div>
                <div class="timeline-item">
                    <strong>6. システム統合</strong>
                    <p>個別要素の理解から全体システムの設計へ</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 40px; padding: 30px; background: #f8f9fa; border-radius: 10px;">
                <h3 style="color: #667eea;">🚀 次のステップ</h3>
                <p style="font-size: 1.2em; margin-top: 20px;">
                    この基礎を活かして、より複雑なタスクへ挑戦<br>
                    ・力制御 ・視覚フィードバック ・機械学習との融合
                </p>
            </div>
            <p style="text-align: center; margin-top: 30px; font-style: italic; font-size: 1.2em; color: #667eea;">
                "The best way to learn robotics is to build robots"
            </p>
        </div>
    </div>

    <div class="navigation">
        <button onclick="previousSlide()" id="prevBtn">前へ</button>
        <button onclick="nextSlide()" id="nextBtn">次へ</button>
    </div>

    <script>
        let currentSlide = 1;
        const totalSlides = 20;

        function showSlide(n) {
            const slides = document.getElementsByClassName('slide');
            
            if (n > totalSlides) currentSlide = 1;
            if (n < 1) currentSlide = totalSlides;
            
            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove('active');
            }
            
            slides[currentSlide - 1].classList.add('active');
            
            // Update slide number
            document.getElementById('slideNumber').textContent = `${currentSlide} / ${totalSlides}`;
            
            // Update progress bar
            const progress = (currentSlide / totalSlides) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // Update button states
            document.getElementById('prevBtn').disabled = currentSlide === 1;
            document.getElementById('nextBtn').disabled = currentSlide === totalSlides;
        }

        function nextSlide() {
            currentSlide++;
            showSlide(currentSlide);
        }

        function previousSlide() {
            currentSlide--;
            showSlide(currentSlide);
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowLeft') previousSlide();
            if (event.key === 'ArrowRight') nextSlide();
            if (event.key === 'Home') { currentSlide = 1; showSlide(1); }
            if (event.key === 'End') { currentSlide = totalSlides; showSlide(totalSlides); }
        });

        // Initialize
        showSlide(1);
        
        // Add smooth scroll for internal links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Timer for presentation mode (optional)
        let presentationTimer;
        let elapsedTime = 0;
        
        function startTimer() {
            presentationTimer = setInterval(() => {
                elapsedTime++;
                const minutes = Math.floor(elapsedTime / 60);
                const seconds = elapsedTime % 60;
                console.log(`Presentation time: ${minutes}:${seconds.toString().padStart(2, '0')}`);
            }, 1000);
        }
        
        function stopTimer() {
            clearInterval(presentationTimer);
        }
        
        // Auto-start timer
        startTimer();
    </script>
</body>
</html>
